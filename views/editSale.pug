doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    title Edit Sale | MWF Ltd
    link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css")
    link(rel="stylesheet" href="../css/recordSale.css")
  body
    .container.py-5
      .row.justify-content-center
        .col-lg-8
          .card.shadow-lg.rounded-4
            .card-header.bg-primary.text-white.text-center.py-3.rounded-top-4
              h3 Edit Sale
            .card-body.p-4
              form#editSaleForm(action=`/edit-sale/${sale._id}`  method="POST" autocomplete="on")
                // Sales Agent
                .mb-3
                  label.form-label Sales Agent
                  input.form-control(type="text" value=sale.salesAgent.fullName readonly)

                // Product Type
                .mb-3
                  label.form-label Product Type
                  input.form-control(type="text" value=sale.productType readonly)

                // Product Name
                .mb-3
                  label.form-label Product
                  input.form-control(type="text" value=sale.productName readonly)

                // Available Stock
                .mb-3
                  label.form-label Available Stock
                  input#availableStock.form-control(type="number" value=sale.availableStock readonly)

                // Unit Price
                .mb-3
                  label.form-label Unit Price (UGX)
                  input#unitPrice.form-control(type="number" name="unitPrice" value=sale.sellingPrice readonly)

                // Quantity
                .mb-3
                  label.form-label Quantity
                  input#quantity.form-control(type="number" name="quantity" min="1" value=sale.quantity required)

                // Transportation dropdown
                .mb-3
                  label.form-label Transportation
                  select#transportation.form-select(name="transportation" required)
                    option(value="self" selected=(sale.transportation === "self")) Self
                    option(value="company" selected=(sale.transportation === "company")) Company (+5% cost)

                // Total Cost
                .mb-3
                  label.form-label Total Cost (UGX)
                  input#totalCost.form-control(type="number" name="totalCost" value=sale.totalCost readonly)

                // Customer Name
                .mb-3
                  label.form-label Customer Name
                  input.form-control(type="text" name="customerName" value=sale.customerName required)

                // Payment Method
                .mb-3
                  label.form-label Payment Method
                  select.form-select(name="paymentMethod" required)
                    option(value="" disabled) Select payment method
                    option(value="Cash" selected=(sale.paymentMethod === "Cash")) Cash
                    option(value="Bank-Transfer" selected=(sale.paymentMethod === "Bank-Transfer")) Bank Transfer
                    option(value="Mobile-Money" selected=(sale.paymentMethod === "Mobile-Money")) Mobile Money

                // Sale Date
                .mb-3
                  label.form-label Date of Sale
                  input.form-control(type="date" name="dateOfSale" value=sale.dateOfSale.toISOString().substring(0,10) required)

                .d-flex.justify-content-between.mt-4
                  button.btn.btn-success(type="submit") Update Sale
                  a.btn.btn-outline-secondary(href="/all-sales") Cancel

    // Footer
    footer.site-footer.text-center.py-3.mt-5
      small © 
        span#year
        |  MWF Ltd • All rights reserved.

    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js")
    script.
      window.saleData = !{JSON.stringify(sale)};
    script(src="../js/editSale.js")
